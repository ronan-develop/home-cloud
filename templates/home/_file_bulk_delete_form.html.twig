{# Formulaire de suppression en masse des fichiers #}
<form method="post" class="mb-4 flex flex-col gap-4">
	<input type="hidden" name="_token" value="{{ csrf_token('bulk_delete') }}">
	<div class="mb-2 w-full flex flex-col">
		<div>
			<label for="filter-name" class="block text-xs font-semibold mb-1">Filtrer nom</label>
			<input type="text" class="block border rounded px-2 py-1 text-sm w-full mb-2" placeholder="Filtrer nom" id="filter-name">
		</div>
		<div>
			<label for="filter-date" class="block text-xs font-semibold mb-1">Filtrer date</label>
			<input type="text" class="block border rounded px-2 py-1 text-sm w-full" placeholder="Filtrer date" id="filter-date">
		</div>
		<div class="overflow-x-auto">
			<table id="file-table" class="min-w-full border rounded shadow text-sm">
				<thead class="bg-gray-50">
					<tr>
						<th class="p-2 text-left font-semibold">&nbsp;</th>
						<th class="p-2 text-left font-semibold cursor-pointer" data-sort="name">Nom
							<span class="text-xs">⇅</span>
						</th>
						<th class="p-2 text-left font-semibold cursor-pointer" data-sort="date">Date
							<span class="text-xs">⇅</span>
						</th>
						<th class="p-2 text-left font-semibold cursor-pointer" data-sort="size">Taille
							<span class="text-xs">⇅</span>
						</th>
						<th class="p-2 text-left font-semibold">Actions</th>
					</tr>
				</thead>
				<tbody>
					{% for file in filesPager.currentPageResults %}
						<tr class="border-b">
							<td class="p-2 align-middle">
								<input type="checkbox" name="files[]" value="{{ file.id }}" class="form-checkbox file-checkbox">
							</td>
							<td class="p-2 align-middle font-mono break-all">{{ file.name }}</td>
							<td class="p-2 align-middle text-xs text-gray-500">{{ file.uploadedAt|date('d/m/Y H:i') }}</td>
							<td class="p-2 align-middle text-xs text-gray-500">{{ file.size|number_format(0, ',', ' ') }}
								octets</td>
							<td class="p-2 align-middle flex gap-2">
								<a href="{{ path('file_download', {id: file.id}) }}" class="btn btn-blue" title="Télécharger le fichier">Télécharger</a>
								<form method="post" action="{{ path('file_delete', {id: file.id}) }}" style="display:inline" onsubmit="return confirm('Supprimer ce fichier ?')">
									<input type="hidden" name="_token" value="{{ csrf_token('delete_' ~ file.id) }}">
									<button type="submit" class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs transition" title="Supprimer le fichier">Supprimer</button>
								</form>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		<div class="flex gap-4 mt-4">
			<button type="submit" formaction="{{ path('file_download_selected_zip') }}" id="bulk-zip-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition hidden">Télécharger ZIP</button>
			<button type="submit" formaction="{{ path('file_bulk_delete') }}" id="bulk-delete-btn" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition hidden" onclick="return confirm('Supprimer les fichiers sélectionnés ?')">Supprimer</button>
		</div>
	</form>
	<script src="{{ asset('file-table.js') }}"></script>
