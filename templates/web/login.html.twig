{% extends 'base.html.twig' %}

{% block title %}Connexion — HomeCloud{% endblock %}

{% block body %}
<link rel="stylesheet" href="{{ asset('styles/main.css') }}">

<!-- 1. Fond animé -->
<div class="animated-bg" aria-hidden="true">
  <div class="bg-blob-mid"></div>
</div>

<!-- 2. SVG filter caché (distorsion Liquid Glass) -->
<svg class="hidden" style="position:absolute;width:0;height:0;" aria-hidden="true">
  <defs>
    <filter id="lg" x="-20%" y="-20%" width="140%" height="140%" color-interpolation-filters="sRGB">
      <feTurbulence type="fractalNoise" baseFrequency="0.50 0.60" numOctaves="2" seed="7" result="noise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="6" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </defs>
</svg>

<!-- Centrage -->
<div class="login-wrapper">

  <!-- 3. Carte Liquid Glass -->
  <div class="lg-card">

    <!-- Couche 1 : distorsion + flou -->
    <div class="lg-blur"></div>
    <!-- Couche 2 : teinte -->
    <div class="lg-tint"></div>
    <!-- Couche 3 : reflet spéculaire -->
    <div class="lg-shine"></div>
    <!-- Couche 4 : ligne de reflet haute -->
    <div class="lg-topline"></div>

    <!-- Couche 5 : contenu -->
    <div class="lg-content">

      <!-- Logo + en-tête -->
      <div style="text-align:center;margin-bottom:0.25rem;">
        <div class="logo-icon">☁️</div>
        <h1 class="lg-title">HomeCloud</h1>
        <p class="lg-subtitle">Connectez-vous à votre espace</p>
      </div>

      <!-- Erreur d'authentification -->
      {% if error %}
        <div class="lg-error">
          <span>⚠️</span>
          <span>{{ error.messageKey|trans(error.messageData, 'security') }}</span>
        </div>
      {% endif %}

      <!-- Formulaire -->
      <form method="post" action="{{ path('app_login') }}">
        <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

        <div>
          <label class="lg-label" for="email">Adresse e-mail</label>
          <input
            class="lg-input"
            type="email"
            id="email"
            name="email"
            value="{{ last_username }}"
            autocomplete="email"
            required
            autofocus
            placeholder="vous@example.com"
          >
        </div>

        <div>
          <label class="lg-label" for="password">Mot de passe</label>
          <input
            class="lg-input"
            type="password"
            id="password"
            name="password"
            autocomplete="current-password"
            required
            placeholder="••••••••"
          >
        </div>

        <button type="submit" class="lg-btn">Se connecter</button>
      </form>

    </div><!-- /lg-content -->
  </div><!-- /lg-card -->

</div><!-- /login-wrapper -->
{% endblock %}
