{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('styles/main.css') }}">
{% endblock %}
{% extends 'base.html.twig' %}

{% block body %}

{# Navbar Liquid Glass #}
<nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-white/40 shadow-sm px-6 py-3 flex items-center justify-between">
    <a href="{{ path('app_home') }}" class="flex items-center gap-2 font-bold text-gray-900 hover:text-blue-600 transition-colors">
        <span class="navbar-logo"><span class="navbar-logo-cloud">â˜ï¸</span></span>
        <span class="navbar-logo-title">HomeCloud</span>
    </a>
    <div class="flex items-center gap-3">
        <span class="text-sm text-gray-500">{{ app.user.displayName }}</span>
        <a href="{{ path('app_logout') }}"
           class="text-sm px-3 py-1.5 rounded-lg text-gray-500 hover:bg-red-50 hover:text-red-600 transition-colors">
            DÃ©connexion
        </a>
    </div>
</nav>

<div class="flex min-h-[calc(100vh-53px)]">

    {# Sidebar Liquid Glass #}
    <aside class="w-56 shrink-0 bg-white/70 backdrop-blur-md border-r border-white/40 p-3 flex flex-col gap-0.5">
        {% set nav_items = [
            { route: 'app_home', icon: 'ğŸ“', label: 'Mes fichiers' },
            { route: '#',        icon: 'ğŸ–¼ï¸', label: 'Galerie' },
            { route: '#',        icon: 'ğŸ“š', label: 'Albums' },
            { route: '#',        icon: 'ğŸ”—', label: 'Partages' },
        ] %}
        {% for item in nav_items %}
            <a href="{{ item.route starts with '#' ? '#' : path(item.route) }}"
               class="flex items-center gap-2.5 px-3 py-2 rounded-xl text-sm text-gray-600
                      hover:bg-white/80 hover:text-gray-900 hover:shadow-sm transition-all">
                <span>{{ item.icon }}</span>
                {{ item.label }}
            </a>
        {% endfor %}
    </aside>

    {# Zone principale #}
    <main class="flex-1 p-6 overflow-auto">

        {# Flash messages #}
        {% for type, messages in app.flashes %}
            {% for message in messages %}
                <div class="mb-4 px-4 py-3 rounded-2xl text-sm flex items-center gap-2
                    flash-{{ type }}
                    {% if type == 'error' %}bg-red-50 border border-red-100 text-red-600
                    {% elseif type == 'success' %}bg-green-50 border border-green-100 text-green-700
                    {% else %}bg-blue-50 border border-blue-100 text-blue-700{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}

        {% block content %}{% endblock %}
    </main>
</div>

{# Capture phase : empÃªche le browser d'ouvrir le fichier sauf sur la zone upload #}
<script>
(function () {
    function block(e) {
        var zone = document.querySelector('[data-controller="file-upload"]');
        if (zone && zone.contains(e.target)) return; // laisser passer sur la zone
        e.preventDefault();
    }
    window.addEventListener('dragover', block, true);
    window.addEventListener('drop',     block, true);
})();
</script>

{% endblock %}
